<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>롯데ON 마이페이지</title>
    <!-- 달력 -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/moment/min/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>

    <link rel="shortcut icon" type="image/x-icon" href="/static/images/main/favicon.ico" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="/static/css/my/star-rating-svg.css">
    <link rel="stylesheet" href="/static/css/my/style.css">
    <link rel="stylesheet" href="/static/css/header.css">
    <link rel="stylesheet" href="/static/css/footer.css">
    <link rel="stylesheet" href="/static/css/my/order.css">
    <style>
    #wrapper {
        width: 1200px; /* 원하는 고정 너비 설정 */
        margin: 0 auto; /* 화면 가운데 정렬 */
    }

        .myinfoSearch {
        display: flex;
        align-items: center;
        gap: 5px; /* 요소 간의 간격 */
        flex-wrap: nowrap; /* 모든 요소를 한 줄에 유지 */
        background-color: #f7f7f7;
    }
        /* 공통 스타일 */
.myinfoSearch input,
.myinfoSearch button,
.myinfoSearch a {
    width: 50px; 
    padding: 5px 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    text-align: center;
}
.myinfoSearch #monthSelect{
    width: 130px; 
    padding: 5px 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    text-align: center;
}
.myinfoSearch a {
    text-decoration: none;
    color: #007bff;
    border: 1px solid #007bff;
    background-color: white;
    cursor: pointer;
}

.myinfoSearch button {
    background-color: #007bff;
    color: white;
    border: none;
    cursor: pointer;
}
.date-wrapper {
    display: flex;
    justify-content: space-between;
    gap: 3px;
}
#startDate, 
#endDate {
    text-align: center;
    width: 100px; /* 원하는 너비로 설정 */
    border: 1px solid #ccc;
    border-radius: 6px;
}
/* 라벨 스타일 */
.myinfoSearch label {
    font-weight: bold;
    display: block;
    margin-bottom: 6px;
}

    </style>
</head>
<body>
    <div id="wrapper">
        <header class="header">
            <div class="header__top">
                <div class="center header__top__nav">
                    <a href="#" th:href="@{/member/login}">로그인</a>
                    <a href="#" th:href="@{/member/join}">회원가입</a>
                    <a href="#" th:href="@{/my/home(userId=${#authentication.principal.user.userId})}">마이페이지</a>
                    <i class="fa fa-shopping-cart" aria-hidden="true"></i>&nbsp;장바구니
                    </a>
                    <a href="#" th:href="@{/member/logout}">로그아웃</a>
                </div>
            </div>
            <div class="header__bot">
                <div class="header__bot__wrapper center">
                    <a class="logo" href="#" th:href="@{/}"><img class="logo__img" src="/static/images/header_logo.png" th:src="@{/images/header_logo.png}" alt="로고"/></a>
                    <form class="search" action="/lotteon/product/search" method="get">
                        <input class="search__input" type="text" name="keyword"/>
                        <button class="search__btn"><img width="18" class="search__btn__img" src="/static/images/search.svg" /></button>
                    </form>
                </div>
            </div>
        </header>

        <!-- 내용 시작 -->
        <div id="my">
            <nav>
                <div>
                    <a href="/static/js/my/home"><img src="/static/images/my/my_logo.jpg" alt="나의쇼핑정보"></a>
                    <ol>
                        <li><a href="/my/order">주문·배송</a></li>
                        <li><a href="/my/coupon">할인쿠폰</a></li>
                        <li><a href="/my/point">포인트</a></li>
                        <li><a href="/my/qna">문의내역</a></li>
                    </ol>
                </div>
            </nav>

            <div class="ordered">
                <!-- 마이페이지 사이드바 -->
                <ul class="myCate">
                    <span class="menu_else"></span>
                    <li><a href="#">전체주문내역</a></li>
                    <li><a href="#">관심상품</a></li>
                    <li><a href="#">포인트내역</a></li>
                    <li><a href="#">쿠폰</a></li>
                    <li><a href="#">나의리뷰</a></li>
                    <li><a href="#">문의하기</a></li>
                    <li><a href="#">나의설정</a></li>
                </ul>

                <section>
                    <a href="#"><img src="/static/images/my/my_banner1.jpg" alt="패션, 타운 하나로 끝" class="banner"></a>

                    <article class="latest">
                        <h3>전체주문내역</h3>
                        <!-- 주문내역 검색바 -->
                        <div class="myinfoSearch">
                            <p>기간별 조회</p>
                            <a href="/my/order">전체</a>
                            <a href="/my/order?cate=week">일주일</a>
                            <a href="/my/order?cate=halfmonth">15일</a>
                            <a href="/my/order?cate=month">1개월</a>
                            <select id="monthSelect">
                                <option value="">검색 기간 선택</option>
                            </select>
                            <div class="date-wrapper">
                                <div class="start-date-wrapper">
                                    <input type="text" id="startDate" class="start-date" readonly placeholder="시작 날짜 선택">
                                </div>

                                <div class="end-date-wrapper">
                                    <input type="text" id="endDate" class="end-date" readonly placeholder="종료 날짜 선택">
                                </div>
                            </div>
                            <button onclick="searchOrders()">검색</button>
                        </div>
                    </article>
                </section>
            </div>
        </div>

        <script>
            // 오늘 달로부터 5개월 전까지의 월 목록을 생성하는 함수
            function generateMonthOptions() {
                const select = document.getElementById('monthSelect');
                const currentDate = new Date();
                const currentMonth = currentDate.getMonth(); // 현재 월 (0부터 시작)
                const currentYear = currentDate.getFullYear();
            
                // 오늘로부터 5개월 전까지의 월 리스트 생성
                for (let i = 0; i < 6; i++) {
                    const date = new Date(currentYear, currentMonth - i);
                    const year = date.getFullYear();
                    const month = date.getMonth() + 1; // 0부터 시작하므로 +1
                    const optionText = `${year}년 ${month}월`;
                    const optionValue = `${year}-${month.toString().padStart(2, '0')}`;
                    const option = document.createElement('option');
                    option.value = optionValue;
                    option.text = optionText;
                    select.appendChild(option);
                }
            }

            $(function() {
                // 오늘 기준으로 최대 3년 전까지 선택 가능
                let maxYear = moment().year(); // 현재 년도
                let minYear = maxYear - 3; // 최대 3년 전까지 허용

                // 시작 날짜 선택
                $('#startDate').daterangepicker({
                    singleDatePicker: true,
                    locale: {
                        format: 'YYYY-MM-DD',
                    },
                    maxDate: new Date(),
                    autoApply: true,
                    autoUpdateInput: false,
                    showDropdowns: true,
                    minYear: minYear,
                    maxYear: maxYear,
                }, function(start) {
                    $('#startDate').val(start.format('YYYY-MM-DD'));
                    $('#endDate').val(''); // 종료 날짜 초기화
                    $('#endDate').daterangepicker({
                        singleDatePicker: true,
                        locale: {
                            format: 'YYYY-MM-DD',
                        },
                        minDate: start,
                        maxDate: moment(start).add(1, 'years'),
                        autoApply: true,
                        autoUpdateInput: false,
                        showDropdowns: true,
                    }, function(end) {
                        $('#endDate').val(end.format('YYYY-MM-DD'));
                    });
                });

                $('#monthSelect').on('change', function() {
                    if (this.value) {
                        $('#startDate').val(''); // 시작 날짜 초기화
                        $('#endDate').val(''); // 종료 날짜 초기화
                    }
                });
            });

            window.onload = function() {
                generateMonthOptions(); // 오늘로부터 5개월 전까지의 목록 생성
            };
        </script>
    </body>
</html>
